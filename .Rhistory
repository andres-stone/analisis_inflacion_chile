View(EEE)
EEE <- EEE[-1,]
View(EEE)
EEE <- EEE[-1,c(1:2)]
View(EEE)
EEE <- "EEE.xlsx"
EEE <- read_excel(paste0("datos/",EEE))
EEE <- EEE[-2,c(1:3)]
View(EEE)
EEE <- "EEE.xlsx"
EEE <- read_excel(paste0("datos/",EEE))
EEE <- EEE[-2,c(1:3)]
View(EEE)
EEE <- "EEE.xlsx"
EEE <- read_excel(paste0("datos/",EEE))
View(EEE)
EEE <- EEE[-c(1:2),c(1:3)]
View(EEE)
EEE <- "EEE.xlsx"
EEE <- read_excel(paste0("datos/",EEE))
View(EEE)
EEE <- EEE[-1,c(1:3)]
colnames(EEE) <- c("Periodo", "EEE a un año", "EEE a dos años")
EOF <- read_excel(paste0("datos/",EOF))
EOF <- EOF[-1,c(1:3)]
View(EOF)
colnames(EOF) <- c("Periodo", "EOF a un año", "EOF a dos años")
View(EOF)
# Uniendo las bases desde que se encuentran y hasta donde lleguen
eee_eof <- EEE %>%
inner_join(EOF, by = c("Periodo"))
View(eee_eof)
# Uniendo las bases desde que se encuentran y hasta donde lleguen
EEE_EOF <- EEE %>%
inner_join(EOF, by = c("Periodo"))
View(EEE_EOF)
# Uniendo las bases desde que se encuentran y hasta donde lleguen
EEE_EOF <- EEE %>%
inner_join(EOF, by = c("Periodo")) %>%
janitor::clean_names()
View(EEE_EOF)
# Uniendo las bases desde que se encuentran y hasta donde lleguen
# Uniendo las bases desde que se encuentran y hasta donde lleguen
EEE_EOF <- EEE %>%
# Uniendo las bases desde que se encuentran y hasta donde lleguen
EEE_EOF <- EEE %>%
inner_join(EOF, by = c("Periodo")) %>%
mutate(Periodo = as.Date(Periodo, format = '%Y-%m-%d')) %>%
janitor::clean_names()
# Uniendo las bases desde que se encuentran y hasta donde lleguen
EEE_EOF <- EEE %>%
inner_join(EOF, by = c("Periodo")) %>%
janitor::clean_names()
# Uniendo las bases desde que se encuentran y hasta donde lleguen
EEE_EOF <- EEE %>%
inner_join(EOF, by = c("Periodo")) %>%
janitor::clean_names() %>%
mutate(periodo = as.Date(periodo, format = '%Y-%m-%d'),
)
View(EEE_EOF)
# Uniendo las bases desde que se encuentran y hasta donde lleguen
EEE_EOF <- EEE %>%
inner_join(EOF, by = c("Periodo")) %>%
janitor::clean_names() %>%
mutate(periodo = as.Date(periodo, format = '%Y-%m-%d'),
eee_a_un_ano = as.numeric(eee_a_un_ano),
eee_a_dos_anos = as.numeric(eee_a_dos_anos),
eof_a_un_ano = as.numeric(eof_a_un_ano),
eof_a_dos_anos = as.numeric(eof_a_dos_anos))
View(EEE_EOF)
# Uniendo las bases desde que se encuentran y hasta donde lleguen
EEE_EOF <- EEE %>%
inner_join(EOF, by = c("Periodo")) %>%
janitor::clean_names() %>%
mutate(periodo = as.Date(periodo, format = '%Y-%m-%d'),
eee_a_un_ano   = round(as.numeric(eee_a_un_ano),2),
eee_a_dos_anos = round(as.numeric(eee_a_dos_anos),2),
eof_a_un_ano   = round(as.numeric(eof_a_un_ano),2),
eof_a_dos_anos = round(as.numeric(eof_a_dos_anos),2))
View(EEE_EOF)
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = Periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = Periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = Periodo, y = eof_a_un_ano, group = 1, color = "EOF a un años")) +
geom_line(data = EEE_EOF,
aes(x = Periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años"));plot_eee_eof
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años"));plot_eee_eof
# Uniendo las bases desde que se encuentran
EEE_EOF <- EEE %>%
inner_join(EOF, by = c("Periodo")) %>%
janitor::clean_names() %>%
mutate(periodo = as.Date(periodo, format = '%Y-%m-%d'),
eee_a_un_ano   = round(as.numeric(eee_a_un_ano),2),
eee_a_dos_anos = round(as.numeric(eee_a_dos_anos),2),
eof_a_un_ano   = round(as.numeric(eof_a_un_ano),2),
eof_a_dos_anos = round(as.numeric(eof_a_dos_anos),2)) %>%
filter(periodo >= '2020-01-01')
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años"));plot_eee_eof
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años")) +
scale_color_manual("",values = c("EEE a un año"   = "chartreuse4",
"EEE a dos años" = "violetred3",
"EOF a un año"   = "royalblue4",
"EOF a dos años" = "darkgoldenrod3"));plot_eee_eof
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años")) +
scale_color_manual("",values = c("EEE a un año"   = "chartreuse4",
"EEE a dos años" = "violetred3",
"EOF a un año"   = "royalblue4",
"EOF a dos años" = "darkgoldenrod3")) +
theme_light();plot_eee_eof
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años")) +
scale_color_manual("",values = c("EEE a un año"   = "chartreuse4",
"EEE a dos años" = "violetred3",
"EOF a un año"   = "royalblue4",
"EOF a dos años" = "darkgoldenrod3")) +
theme_light() +
labs(x = NULL, y = "Variación anual (%)",
title = "Expectativas de inflación en las encuestas",
subtitle = paste0("enero 2020 - diciembre 2021"),
caption  = "Fuente: Elaboración propia utilizando datos del BCCh");plot_eee_eof
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años")) +
scale_color_manual("",values = c("EEE a un año"   = "chartreuse4",
"EEE a dos años" = "violetred3",
"EOF a un año"   = "royalblue4",
"EOF a dos años" = "darkgoldenrod3")) +
theme_light() +
labs(x = NULL, y = "Variación anual (%)",
title = "Expectativas de inflación en las encuestas",
subtitle = paste0("enero 2020 - diciembre 2021"),
caption  = "Fuente: Elaboración propia utilizando datos del BCCh") +
scale_x_date(limits = c(min(EEE_EOF$periodo),
max = max(EEE_EOF$periodo)),
date_breaks = "3 months") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(linetype="dashed"),
panel.grid.minor.y = element_line(linetype="dashed"),
legend.position = "bottom",
legend.justification = "center",
plot.caption = element_text(hjust = 0),
plot.title = element_text(colour = "blue4", hjust = 0.5),
plot.subtitle = element_text(colour = "blue4",hjust = 0.5),
legend.title = element_text(colour = NA),
panel.background = element_rect(fill = NA),
plot.background = element_rect(fill = "white",colour = NA),
legend.background = element_rect(fill = "white"),
legend.direction = "horizontal",
legend.key = element_rect(fill="white"),
axis.text.x   = element_text(colour = "grey0"
,size = 8, angle = 90
,hjust = 1, vjust = 1));plot_eee_eof
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_hline(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un año")) +
geom_hline(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años")) +
scale_color_manual("",values = c("EEE a un año"   = "chartreuse4",
"EEE a dos años" = "violetred3",
"EOF a un año"   = "royalblue4",
"EOF a dos años" = "darkgoldenrod3")) +
theme_light() +
labs(x = NULL, y = "Variación anual (%)",
title = "Expectativas de inflación en las encuestas",
subtitle = paste0("enero 2020 - diciembre 2021"),
caption  = "Fuente: Elaboración propia utilizando datos del BCCh") +
scale_x_date(limits = c(min(EEE_EOF$periodo),
max = max(EEE_EOF$periodo)),
date_breaks = "3 months") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(linetype="dashed"),
panel.grid.minor.y = element_line(linetype="dashed"),
legend.position = "bottom",
legend.justification = "center",
plot.caption = element_text(hjust = 0),
plot.title = element_text(colour = "blue4", hjust = 0.5),
plot.subtitle = element_text(colour = "blue4",hjust = 0.5),
legend.title = element_text(colour = NA),
panel.background = element_rect(fill = NA),
plot.background = element_rect(fill = "white",colour = NA),
legend.background = element_rect(fill = "white"),
legend.direction = "horizontal",
legend.key = element_rect(fill="white"),
axis.text.x   = element_text(colour = "grey0"
,size = 8, angle = 90
,hjust = 1, vjust = 1));plot_eee_eof
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos,
group = 1, color = "EEE a dos años", linetype = "dashed")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos,
group = 1, color = "EOF a dos años", linetype = "dashed")) +
scale_color_manual("",values = c("EEE a un año"   = "chartreuse4",
"EEE a dos años" = "violetred3",
"EOF a un año"   = "royalblue4",
"EOF a dos años" = "darkgoldenrod3")) +
theme_light() +
labs(x = NULL, y = "Variación anual (%)",
title = "Expectativas de inflación en las encuestas",
subtitle = paste0("enero 2020 - diciembre 2021"),
caption  = "Fuente: Elaboración propia utilizando datos del BCCh") +
scale_x_date(limits = c(min(EEE_EOF$periodo),
max = max(EEE_EOF$periodo)),
date_breaks = "3 months") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(linetype="dashed"),
panel.grid.minor.y = element_line(linetype="dashed"),
legend.position = "bottom",
legend.justification = "center",
plot.caption = element_text(hjust = 0),
plot.title = element_text(colour = "blue4", hjust = 0.5),
plot.subtitle = element_text(colour = "blue4",hjust = 0.5),
legend.title = element_text(colour = NA),
panel.background = element_rect(fill = NA),
plot.background = element_rect(fill = "white",colour = NA),
legend.background = element_rect(fill = "white"),
legend.direction = "horizontal",
legend.key = element_rect(fill="white"),
axis.text.x   = element_text(colour = "grey0"
,size = 8, angle = 90
,hjust = 1, vjust = 1));plot_eee_eof
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años")) +
scale_color_manual("",values = c("EEE a un año"   = "chartreuse4",
"EEE a dos años" = "violetred3",
"EOF a un año"   = "royalblue4",
"EOF a dos años" = "darkgoldenrod3")) +
scale_linetype_manual(values=c("solid", "twodash","solid", "twodash")) +
theme_light() +
labs(x = NULL, y = "Variación anual (%)",
title = "Expectativas de inflación en las encuestas",
subtitle = paste0("enero 2020 - diciembre 2021"),
caption  = "Fuente: Elaboración propia utilizando datos del BCCh") +
scale_x_date(limits = c(min(EEE_EOF$periodo),
max = max(EEE_EOF$periodo)),
date_breaks = "3 months") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(linetype="dashed"),
panel.grid.minor.y = element_line(linetype="dashed"),
legend.position = "bottom",
legend.justification = "center",
plot.caption = element_text(hjust = 0),
plot.title = element_text(colour = "blue4", hjust = 0.5),
plot.subtitle = element_text(colour = "blue4",hjust = 0.5),
legend.title = element_text(colour = NA),
panel.background = element_rect(fill = NA),
plot.background = element_rect(fill = "white",colour = NA),
legend.background = element_rect(fill = "white"),
legend.direction = "horizontal",
legend.key = element_rect(fill="white"),
axis.text.x   = element_text(colour = "grey0"
,size = 8, angle = 90
,hjust = 1, vjust = 1));plot_eee_eof
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años")) +
scale_color_manual("",values = c("EEE a un año"   = "chartreuse4",
"EEE a dos años" = "violetred3",
"EOF a un año"   = "royalblue4",
"EOF a dos años" = "darkgoldenrod3")) +
theme_light() +
labs(x = NULL, y = "Variación anual (%)",
title = "Expectativas de inflación en las encuestas",
subtitle = paste0("enero 2020 - diciembre 2021"),
caption  = "Fuente: Elaboración propia utilizando datos del BCCh") +
scale_x_date(limits = c(min(EEE_EOF$periodo),
max = max(EEE_EOF$periodo)),
date_breaks = "3 months") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(linetype="dashed"),
panel.grid.minor.y = element_line(linetype="dashed"),
legend.position = "bottom",
legend.justification = "center",
plot.caption = element_text(hjust = 0),
plot.title = element_text(colour = "blue4", hjust = 0.5),
plot.subtitle = element_text(colour = "blue4",hjust = 0.5),
legend.title = element_text(colour = NA),
panel.background = element_rect(fill = NA),
plot.background = element_rect(fill = "white",colour = NA),
legend.background = element_rect(fill = "white"),
legend.direction = "horizontal",
legend.key = element_rect(fill="white"),
axis.text.x   = element_text(colour = "grey0"
,size = 8, angle = 90
,hjust = 1, vjust = 1));plot_eee_eof
View(EEE)
View(EEE_EOF)
# Encuesta de Expectativas Económicas
EEE <- read_excel(paste0("datos/",EEE))
# Uniendo las bases desde que se encuentran
EEE_EOF <- EEE %>%
inner_join(EOF, by = c("Periodo")) %>%
janitor::clean_names() %>%
mutate(periodo = as.Date(periodo, format = '%Y-%m-%d'),
eee_a_un_ano   = round(as.numeric(eee_a_un_ano),1),
eee_a_dos_anos = round(as.numeric(eee_a_dos_anos),1),
eof_a_un_ano   = round(as.numeric(eof_a_un_ano),1),
eof_a_dos_anos = round(as.numeric(eof_a_dos_anos),1)) %>%
filter(periodo >= '2020-01-01')
# Gráfica
plot_eee_eof <- ggplot() +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_un_ano, group = 1, color = "EEE a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eee_a_dos_anos, group = 1, color = "EEE a dos años")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_un_ano, group = 1, color = "EOF a un año")) +
geom_line(data = EEE_EOF,
aes(x = periodo, y = eof_a_dos_anos, group = 1, color = "EOF a dos años")) +
scale_color_manual("",values = c("EEE a un año"   = "chartreuse4",
"EEE a dos años" = "violetred3",
"EOF a un año"   = "royalblue4",
"EOF a dos años" = "darkgoldenrod3")) +
theme_light() +
labs(x = NULL, y = "Variación anual (%)",
title = "Expectativas de inflación en las encuestas",
subtitle = paste0("enero 2020 - diciembre 2021"),
caption  = "Fuente: Elaboración propia utilizando datos del BCCh") +
scale_x_date(limits = c(min(EEE_EOF$periodo),
max = max(EEE_EOF$periodo)),
date_breaks = "3 months") +
theme(panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank(),
panel.grid.major.y = element_line(linetype="dashed"),
panel.grid.minor.y = element_line(linetype="dashed"),
legend.position = "bottom",
legend.justification = "center",
plot.caption = element_text(hjust = 0),
plot.title = element_text(colour = "blue4", hjust = 0.5),
plot.subtitle = element_text(colour = "blue4",hjust = 0.5),
legend.title = element_text(colour = NA),
panel.background = element_rect(fill = NA),
plot.background = element_rect(fill = "white",colour = NA),
legend.background = element_rect(fill = "white"),
legend.direction = "horizontal",
legend.key = element_rect(fill="white"),
axis.text.x   = element_text(colour = "grey0"
,size = 8, angle = 90
,hjust = 1, vjust = 1));plot_eee_eof
n_eee_eof <- EEE_EOF %>% summarise(n = n_distinct(periodo))
View(n_eee_eof)
n_eee_eof <- n_eee_eof$n
eee_12    <- EEE_EOF$eee_a_un_ano[n]
eee_12    <- EEE_EOF$eee_a_un_ano[n_eee_eof]
eee_12    <- EEE_EOF$eee_a_un_ano[n_eee_eof]
eee_24    <- EEE_EOF$eee_a_dos_anos[n_eee_eof]
eof_12    <- EEE_EOF$eof_a_un_ano[n_eee_eof]
eof_24    <- EEE_EOF$eof_a_dos_anos[n_eee_eof]
#  Seteo inicial
rm(list = ls())
memory.size(max = T)
# Actualizar parametros
mm1 <- "enero"
mm2 <- "1"
yy  <- "2022"
# Nombre bases de datos
url <- "https://www.ine.cl/docs/default-source/%C3%ADndice-de-precios-al-consumidor/cuadros-estadisticos/base-2018/series-de-tiempo/ipc.xls.xlsx?sfvrsn=c73e33d4_10"
dest <- "datos/pi.xlsx"
download.file(url=url,destfile = dest,mode = "wb")
#url_tpm <- "https://si3.bcentral.cl/Siete/ES/Siete/Cuadro/CAP_TASA_INTERES/MN_TASA_INTERES_09/TPM_C1?cbFechaDiaria=1995&cbFrecuencia=MONTHLY&cbCalculo=NONE&cbFechaBase="
#dest_tpm <- "datos/tpm1.xlsx"
#download.file(url = url_tpm, destfile = dest_tpm, mode = "wb")
pi  <- "pi.xlsx"
tpm <- "tpm.xlsx"
EEE <- "EEE.xlsx"
EOF <- "EOF.xlsx"
# Inflación variación anual 12 meses
pi <- read_excel(paste0("datos/",pi)) %>%
janitor::clean_names()
pi <- pi[-c(1:3),]
# d: división, g: grupo, c: clase, sc: subclase, p: producto
colnames(pi) <- c("ano", "mes", "d", "g", "c", "sc", "p", "glosa",
"ponderacion", "indice", "var_mensual", "var_acumulada",
"var_12_meses", "inc_mensual", "inc_acumulada", "inc_12_meses")
pi <- pi %>%
mutate(ponderacion = as.numeric(ponderacion),
indice      = as.numeric(indice),
var_mensual = as.numeric(var_mensual),
var_acumulada = as.numeric(var_acumulada),
var_12_meses  = as.numeric(var_12_meses),
inc_mensual   = as.numeric(inc_mensual),
inc_acumulada = as.numeric(inc_acumulada),
inc_12_meses  = as.numeric(inc_12_meses),
Periodo = as.Date(paste0(ano,"-", mes,"-", "1"), format = '%Y-%m-%d'))
ipc <- pi %>%
filter(glosa == 'IPC General')
# Tasa de Politica Monetaria Mensual
tpm <- read_excel(paste0("datos/",tpm)) %>%
janitor::clean_names()
tpm <- tpm[-1,c(1:2)]
colnames(tpm) <- c('Periodo', 'TPM')
tpm <- tpm  %>%
mutate(TPM     = round(as.numeric(TPM), 2),
Periodo = as.Date(Periodo, format = '%Y-%m-%d'))
# Uniendo bases desde el periodo que se encuentran y hasta donde llegan
ipc_tpm <- ipc %>%
inner_join(tpm, by = c("Periodo")) %>%
mutate(Y = as.numeric(ano),
m = as.numeric(mes)) %>%
select(-c(ano, mes)) %>%
filter(Periodo > '2020-01-01')
# Asignando show_time & reveal_time
ipc_tpm <- ipc_tpm  %>%
mutate(show_time = ifelse((Y == 2020 & m %in% c(3:12))
| Y == 2021, 15, 1),
reveal_time = cumsum(show_time))
# Reshape de base pi_tpm
ipc_tpm_long <- ipc_tpm %>%
select(Periodo, var_12_meses, TPM, reveal_time) %>%
melt(id.vars = c("Periodo", "reveal_time"))
#ipc_tpm_long$Periodo <- gsub('T00:00:00.0000000','', pi_tpm_long$Periodo)
#pi_tpm_long$Y       <- as.numeric(substr(pi_tpm_long$Periodo,1,4))
#pi_tpm_long$m       <- as.numeric(substr(pi_tpm_long$Periodo, 6,7))
#pi_tpm_long$Periodo <- as.Date(pi_tpm_long$Periodo, format = '%Y-%m-%d')
# Datos
l_pi_tpm <- ipc_tpm %>%
filter(Y == yy & m == mm2)
l_pi  <- l_pi_tpm$var_12_meses
l_tpm <- l_pi_tpm$TPM
l_ipc_m <- l_pi_tpm$var_mensual
# Llave
ll_pi  <- ifelse(l_pi > 0, "aumentó", "disminuyó")
# Valor absoluto para llave
abs_l_pi  <- abs(l_pi)
abs_l_tpm <- abs(l_tpm)
View(pi)
